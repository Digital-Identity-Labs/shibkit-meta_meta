<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Documentation by YARD 0.6.1</title>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>Shibkit</h1>

<p>Shibkit is a set of basic tools to help with Shibboleth SP web application development. It supports web applications based on Rack, Sinatra or Rails, although most features are focused on Rails. Rails 3.0 or higher is required.</p>

<h2>Quick'n'Dirty setup notes that really need to be replaced by something coherent</h2>

<p>Load all the major Shibkit libraries by adding this to your application's Gemfile:</p>

<pre class="code"><span class='gem identifier id'>gem</span> <span class='string val'>&quot;shibkit&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:require</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'shibkit'</span>
</pre>

<p>If you are working on Shibkit locally you can add</p>

<p>   gem "shibkit", :require => 'shibkit', :path => "~/Projects/shibkit/workspace"</p>

<p>or to deploy directly from Github, you can use</p>

<pre class="code"><span class='gem identifier id'>gem</span> <span class='string val'>&quot;shibkit&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:require</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'shibkit'</span><span class='comma token'>,</span> <span class='symbol val'>:git</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;git://github.com/binaryape/shibkit.git&quot;</span>
</pre>

<h3>Shibsim</h3>

<p>Shibsim injects fake headers into your session, mimicking the output of an SP.
A real IDP and the WAYF/discovery process are replaced by a simple account chooser.</p>

<p>Shibsim is Rack middleware so it should work with both Rails and Sinattra. It's best
used for development, maybe testing. It is not a real authentication provider!</p>

<p>Enable Shibsim by adding the following to your Rails application.rb:</p>

<pre class="code"><span class='config identifier id'>config</span><span class='dot token'>.</span><span class='middleware identifier id'>middleware</span><span class='dot token'>.</span><span class='use identifier id'>use</span> <span class='string val'>'Shibkit::Rack::Simulator'</span> <span class='if if_mod kw'>if</span> <span class='Rails constant id'>Rails</span><span class='dot token'>.</span><span class='env identifier id'>env</span> <span class='eq op'>==</span> <span class='string val'>'development'</span>
</pre>

<p>Shibsim should work with its own built-in defaults. It isn't easily customisable yet, but this is due soon.</p>

<h3>Shibshim</h3>

<p>Shibshim, named almost identically to its sister library to make your life slightly more confusing, aims to provide a consistent interface between your application and the Shibboleth SP software used to authenticate.</p>

<p>Shibshim reads headers passed by either a real SP installation or Shibsim, and wraps them up in a convenient user object.</p>

<p>Enabling Shibshim involves setting up both a Rack middleware and a (optional) Rails filter.</p>

<p>Add this line to your application.rb (or rackup.ru) after Shibsim:</p>

<pre class="code"><span class='config identifier id'>config</span><span class='dot token'>.</span><span class='middleware identifier id'>middleware</span><span class='dot token'>.</span><span class='use identifier id'>use</span> <span class='string val'>'Shibkit::Rack::Shim'</span>
</pre>

<p>That will provide you with a user object in your session, with lots of nice accessor methods to provide information about the user, their IDP, organisation, etc.</p>

<h3>Rails Extras</h3>

<p>A few Rails extensions are provided to handle sessions, authentication, etc.</p>

<p>To use them you need to extend your Application controller as follows:</p>

<pre class="code"><span class='require identifier id'>require</span>  <span class='string val'>&quot;shibkit/rails/core_controller_mixin&quot;</span>

<span class='class class kw'>class</span> <span class='ApplicationController constant id'>ApplicationController</span> <span class='lt op'>&lt;</span> <span class='ActionController constant id'>ActionController</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>

       <span class='include identifier id'>include</span> <span class='Shibkit constant id'>Shibkit</span><span class='colon2 op'>::</span><span class='Rails constant id'>Rails</span><span class='colon2 op'>::</span><span class='CoreControllerMixin constant id'>CoreControllerMixin</span>

   <span class='before_filter identifier id'>before_filter</span> <span class='Shibkit constant id'>Shibkit</span><span class='colon2 op'>::</span><span class='Rails constant id'>Rails</span><span class='colon2 op'>::</span><span class='SessionFilter constant id'>SessionFilter</span>

   <span class='dot3 op'>...</span>
</pre>

<p>You will need to provide a suitable User class. The one used by DIL at present is based on Mongoid. You'll need to write your own at this point, and I need to document what is needed... Eventually they'll be a generator for a default ActiveRecord one.</p>

<p>The session filter has lots of stages ordered as an authnz workflow. These are basic: the intention is that applications will subclass this filter and replace various stages with their own improved functionality. Dilkit contains filters like this.</p>

<h3>Mongoid Userstamps</h3>

<p>Due to go into its own project at some point. This adds automatic owned_by, created_by, updated_by fields to Mongoid objects. Just put this into your model:</p>

<pre class="code"><span class='include identifier id'>include</span> <span class='Mongoid constant id'>Mongoid</span><span class='colon2 op'>::</span><span class='Userstamps constant id'>Userstamps</span>
</pre>

<h3>Data Tools</h3>

<p>Various utils for creating cargo-culted SP "data".</p>

<pre class="code"><span class='require identifier id'>require</span> <span class='string val'>'shibkit/data_tools'</span>

<span class='DataTools constant id'>DataTools</span><span class='dot token'>.</span><span class='xsid identifier id'>xsid</span>

<span class='dot3 op'>...</span>
</pre>

<h3>MetaMeta</h3>

<p>Library for reading a federation metadata XML file into in-memory objects. Doesn't completely work at present but considering the low LOC I'm suprised it works at all. Needs work.</p>

<h1>Note on Patches/Pull Requests</h1>

<ul>
<li>Fork the project.</li>
<li>Make your feature addition or bug fix.</li>
<li>Add tests for it. This is important so I don't break it in a
future version unintentionally.</li>
<li>Commit, do not mess with rakefile, version, or history.
(if you want to have your own version, that is fine but bump version in a commit by itself I can ignore when I pull)</li>
<li>Send me a pull request. Bonus points for topic branches.</li>
</ul>


<h1>Copyright</h1>

<p>Copyright (c) 2010 Pete Birkinshaw. See LICENSE for details.</p></div></div>
    
    <div id="footer">
  Generated on Sun Oct 31 22:31:49 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.8.7).
</div>

  </body>
</html>